<body>
    <% layout('/layouts/boilerplate') %>
        <div class="filter-container">
            <div class="filter-heading">
                <h3> <b>Propert Type</b></h3>
            </div>
            <div class="filters">
                <div class="filter-btn">
                    <span> <i class="fa-solid fa-house"></i></span>
                    House
                </div>
                <div class="filter-btn">
                    <span> <i class="fa-solid fa-building"></i></span>
                    Flat/Apartment
                </div>

                <div class="filter-btn">
                    <span><i class="fa-solid fa-mountain-city"></i></span>
                    Mountain House
                </div>
                <div class="filter-btn">
                    <span> <i class="fa-solid fa-chess-rook"></i></span>
                    Castle House
                </div>
                <div class="filter-btn">
                    <span> <i class="fa-solid fa-landmark-dome"></i></span>
                    Dome
                </div>
                <div class="filter-btn">
                    <span> <i class="fa-solid fa-hotel"></i></span>
                    Hotel
                </div>
                <div class="toggle-tax">
                    <div class="form-check-reverse form-switch">
                        <input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault">
                        <label class="form-check-label" for="flexSwitchCheckDefault"><b>Display with taxes</b></label>
                    </div>
                </div>
            </div>

        </div>
        <div class="container listing-container">

            <h2>All Listing</h2>
            <br />
            <div class="row">
                <% for(let list of listings) { %>

                    <div class="card col-md-3 col-sm-12 list-card" style="width: 20rem;">
                        <a href="/listing/<%=list._id %>" class="list-item">
                            <img src="<%= list.image.url %>" class="card-img-top" style="height: 15rem;"
                                alt="<%= list.image.filename %>">
                        </a>
                        <div class="card-body">
                            <b class="card-text">
                                <%= list.title %>
                            </b>

                            <p class="card-price">
                                &#x20B9; <%= list.price %>
                            </p>
                        </div>

                    </div>

                    <% } %>

            </div>


        </div>
        <script>
            //   document.querySelector('.fa-house').parentElement.addEventListener('click', () => {
            //       const filteredList = listings.filter(list => list.propertyType === 'House');
            //       console.log(filteredList);
            //   });
            document.querySelector('.form-switch input').addEventListener('click', (e) => {
                //   console.log('clicked');
                const priceTags = document.querySelectorAll('.card-price');
                let newPrice = 0;
              //  console.log(e.target.checked);
                //  console.log(priceTags);
                if (e.target.checked) {
                    priceTags.forEach(tag => {

                        const originalPrice = tag.innerText.split(' ')[1];
                   //     console.log("Original Price: " + originalPrice);
                        const price = parseInt(originalPrice);
                        newPrice = price + (price * 0.18);
                        //  console.log(price+ " .. "+ newPrice);

                        tag.innerHTML = `&#x20B9; ${parseInt(newPrice)} with 18% tax`;

                    })
                } else {
                    priceTags.forEach(tag => {

                        let price = parseInt(tag.innerText.split(' ')[1]);
                        price = parseInt(price / 1.18);
                        console.log("Without tax: " + price);
                        tag.innerHTML = `&#x20B9; ${price} without tax`;
                    })
                }
            });

        </script>
</body>